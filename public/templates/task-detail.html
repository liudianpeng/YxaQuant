<h2>任务详情</h2>
<div class="row">
    <div class="col-md-2">
        <button type="submit" class="btn btn-success">交易中</button>
    </div>      
    <div class="col-md-10">
        <div class="progress">
            <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="35" aria-valuemin="0" aria-valuemax="100" style="width: {{task.progress*100}}%">
                <span class="sr-onlyY">{{task.progress*100}}%</span>
            </div>
        </div>
    </div>      
</div>

<div class="row">
    <div class="col-md-6">
        开始时间： {{task.timeStart}}
    </div>      
    <div class="col-md-6" ng-show="task.status!=='in progress'">
        结束{{task.stocks[0].name}}时间： {{task.timeEnd}}
    </div>      
    <div class="col-sm-12">
            

        <div class="panel panel-default" ng-repeat='stock in task.stocks'>
            <div class="panel-heading"  ng-click="stock.showAccount=!stock.showAccount">
                <div class="panel-title">
                    <h4> {{stock.name||"默认名称"}} <small ng-bind='stock.code||"默认代号FDFFD342342"'></small> </h4>
                </div>
                <div class="panel-options">
                    ￥{{stock.rules.lowestPrice}}~{{stock.rules.highestPrice}}, {{stock.rules.timeStep}}S
                </div>
            </div>
            <div class="panel-body no-padding">
                <table class="table table-bordered datatable" id="table-1"  ng-click="stock.showAccount=!stock.showAccount">
                    <tbody>
                        <tr>
                            <td rowspan="2" width="400">
                                <div class="progress">
                                    <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="35" aria-valuemin="0" aria-valuemax="100" style="width: {{ (sumup(stock.accounts, 'volumeCompleted')*100/sumup(stock.accounts, 'volume')) | number:0 }}%">
                                        <span class="sr-onlyY" ng-bind=" ((sumup(stock.accounts, 'volumeCompleted')*100/sumup(stock.accounts, 'volume')) | number:0) + '%'"></span>
                                    </div>
                                </div>
                            </td>
                            <td>已成交股数：</td>
                            <td ng-bind="sumup(stock.accounts, 'volume')"></td>
                            <td>已成交金额：</td>
                            <td ng-bind="sumup(stock.accounts, 'volumeCompleted')"></td>
                        </tr>
                        <tr>
                            <td>总交股数：</td>
                            <td ng-bind="stock.volume"></td>
                            <td>总金额：</td>
                            <td ng-bind="stock.amount"></td>
                        </tr>
                    </tbody>
                </table>

                <table class="table table-bordered datatable" ng-show="!stock.showAccount" ng-repeat="account in stock.accounts">
                    <tbody>
                        <tr>
                            <td><h4 style="display: inline-block;">{{account.name}}</h4><span style="padding: 5px;background: #eee;">{{account.code}}</span></td>
                            <td>￥{{account.rules.lowestPrice}}~{{account.rules.highestPrice}}</td>
                            <td>{{account.rules.timeStep}}s</td>
                        </tr>
                        <tr>
                            <td>总：{{account.volume}}</td>
                            <td ng-click="account.showDeclarations=true;account.showTransactions=false">申：{{account.volumeDeclared}}</td>
                            <td rowspan="2" style="vertical-align: middle;width: 500px;">

                                <div class="progress">
                                    <div class="progress-bar progress-bar-success" style="width: {{100*account.volumeCompleted/account.volume | number:0}}%">
                                        <span class="sr-onlyY">{{100*account.volumeCompleted/account.volume | number:0}}% (已) </span>
                                    </div>
                                    <div class="progress-bar progress-bar-warning" style="width: {{100*account.volumeDeclared/account.volume | number:0}}%">
                                        <span class="sr-onlyY">{{100*account.volumeDeclared/account.volume | number:0}}% (申) </span>
                                    </div>
                                    <div class="progress-bar progress-bar-danger" style="width: {{100*account.volumeTodo/account.volume | number:0}}%">
                                        <span class="sr-onlyY">{{100*account.volumeTodo/account.volume | number:0}}% (待)</span>
                                    </div>
                                </div>

                            </td>
                        </tr>
                        <tr>
                            <td ng-click="account.showTransactions=true;account.showDeclarations=false">成：{{account.volumeCompleted}}</td>
                            <td>待：{{account.volumeTodo}}</td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <table class="table table-bordered datatable" ng-show="account.showDeclarations" >
                                    <thead>
                                        <tr>
                                            <th>股票</th>
                                            <th>代码</th>
                                            <th>时间</th>
                                            <th>帐户</th>
                                            <th>数量</th>
                                            <th>状态</th>
                                            <th>金额</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="declaration in account.declarations">
                                            <td ng-bind="stock.name"></td>
                                            <td ng-bind="stock.code"></td>
                                            <td ng-bind="showItem.time"></td>
                                            <td ng-bind="account.name"></td>
                                            <td ng-bind="declaration.volume"></td>
                                            <td ng-bind="declaration.status"></td>
                                            <td ng-bind="declaration.amount"></td>
                                        </tr>
                                    </tbody>
                                </table>

                                <table class="table table-bordered datatable" ng-show="account.showTransactions"  >
                                    <thead>
                                        <tr>
                                            <th>股票</th>
                                            <th>代码</th>
                                            <th>时间</th>
                                            <th>帐户</th>
                                            <th>数量</th>
                                            <th>金额</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="transaction in account.transactions">
                                            <td ng-bind="stock.name"></td>
                                            <td ng-bind="stock.code"></td>
                                            <td ng-bind="showItem.time"></td>
                                            <td ng-bind="account.name"></td>
                                            <td ng-bind="transaction.volume"></td>
                                            <td ng-bind="transaction.amount"></td>
                                        </tr>
                                    </tbody>
                                </table>
                                
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

    </div>
</div>